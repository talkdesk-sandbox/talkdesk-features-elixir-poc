# Feature Flags

Talkdesk uses Split to manage Feature Flags. However, the company is taking advantage of clients provided by Split, which does not offer a Elixir client.

The objective of this task is to develop a Proof of Concept (POC) for an Elixir client that connects to Split and is capable of retrieving and validate features.

## Setup

The POC was developed using Elixir version 1.7.3.

To check if you have the correct version use the following command:

```
elixir --version
```

If you do not have the correct version or do not have elixir, you can get it from the [Elixir website](https://elixir-lang.org/install.html).

After getting elixir, install project dependencies with:

```
mix deps.get
```

Finally, you need to set environment variables.

* `SPLIT_IO_API_KEY`: Split IO API key generated by SRE.
* `SPLIT_PERIOD`: Period of time between calls to the Split IO API (defaults to 60000 milliseconds).
* `SPLIT_ENV`: Split IO environment from which we want to retrieve the features (defaults to Staging).  


## Test

To run the tests use:

```
mix test
```

## Start application

To start the application use:

```
iex -S mix
```

With the application running, you can use two commands: get and is_alive.

### get

The get command retrieves a flag with the given name and attributes. If a flag is not available returns the default treatment.

```elixir
FeatureFlags.get(name, attrs \\ [], default \\ "off")
```

As an example:

```elixir
flag = FeatureFlags.get(
  "CXM_prototype_runtime",
  [{"killed", false}, {"rules", []}],
  "off")
```

### is_alive

The is_alive command checks if a given feature flag is active or not.

```elixir
FeatureFlags.is_alive(flag)
```
